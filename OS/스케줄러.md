## 스케줄링

* 현재 실행 중인 프로세스로부터 다른 프로세스로 CPU를 넘겨야 할 때 어떤 프로세스를 선택할지에 대한 기준
* 프로세스 스케줄링은 수행 단계(요구되는 시점)에 따라 ```장기```, ```중기```, ```단기```로 나뉨

<img width="700" alt="스크린샷 2022-10-18 오후 8 11 32" src="https://user-images.githubusercontent.com/97823928/196414223-aeebd832-6a48-491a-b363-12a00e14732d.png">

## 1. 장기 스케줄러

> 어떤 프로세스를 준비큐에 넣을 것인가 결정

어느 작업을 커널에 등록시켜 프로세스로 만들어줄 것인지를 결정하는 것 (생성 -> 준비) 
* 일괄처리 시스템 : 새로 작업이 들어오면 디스크에 놓아둔 채 큐에서 대기하도록 한 후 장기 스케줄러를 거쳐 프로세스가 되도록 함
* 시분할 : 현대의 시분할 시스템에서 사용되는 운영 체제에는 일반적으로 장기 스케줄러를 두지 않는 경우가 대부분임
  * 과거에는 적은 양의 메모리를 많은 프로세스들에게 할당하면 프로세스당 메모리 보유량이 적어져 장기 스케줄러가 이를 조절하는 역할을 했지만 
  * 현대의 운영체제에서는 프로세스가 시작되면 장기 스케줄러 없이 바로 그 프로세스에 메모리를 할당해 준비 큐에 넣어주게 됨 
  
## 2. 중기 스케줄러

> 메모리에 적재된 프로세스 수 관리

* 많은 프로세스에게 메모리를 할당해 시스템의 성능이 저하되는 경우 이를 해결하기 위해 메모리에 적재된 프로세스의 수를 동적으로 조절하기 위해 추가된 스케줄러
* 스왑아웃된 프로세스들 중 어떤 프로세스를 다시 스왑인할 것인가를 결정하는 것

```
스와핑(Swapping) : 장기 스케줄러와 마찬가지로 메모리에 올라와 있는 프로세스의 수를 조절하는 역할을 함
  * 만약 메모리에 많은 수의 프로세스가 적재되어 프로세스 당 보유하고 있는 메모리량이 극도로 적어지면 CPU 수행에 당장 필요한 프로세스의 주소 공간조차도 메모리에 올려놓기 어려운 상황이 발생
  * 그렇게 되면 디스크 I/O가 수시로 발생하게 되어 시스템의 성능이 심각하게 저하될 수 있음
  * 가상메모리 체제에서 너무 많은 프로세스가 적재되면 하드디스크 입출력이 과다해져서 시스템이 거의 멈추는 현상이 발생(Trashing)

Trashing : 메모리 영역에 접근하게 될 때, 메모리에 페이지 부재(=페이지 폴트(Page fault)율이 높은 것을 의미
  * 이런 경우 메모리에 올라와 있는 프로세스 중 일부의 메모리를 통째로 빼앗아 그 내용을 디스크의 스왑 영역에 저장 -> 스왑 아웃(swap out)
  * 디스크로 스왑 아웃시켜야 하는 경우 봉쇄 상태(중단 상태)에 있는 프로세스들을 첫번째로 스왑 아웃 -> 봉쇄 상태의 프로세스들은 당장 CPU를 획득할 가능성이 없기 때문
  * 봉쇄 상태의 프로세스들을 스왑 아웃시켜도 문제가 해결되지 않는 경우 중기 스케줄러는 타이머 인터럽트가 발생해 준비 큐로 이동하는 프로세스를 추가적으로 스왑아웃 시킴
  * 메모리에 여유가 생기면 다시 적재(swap in)
  
중기 스케줄러의 등장으로 프로세스의 상태에는 중지(suspenden, stopped) 상태가 추가 되었으며 중지 상태의 프로세스는 메모리를 통째로 빼앗기고 디스크로 스왑 아웃됨  
```

중지 상태는 중지 준비 상태와 봉쇄 중지 상태가 있다.
* 중지 준비(suspended ready) : 준비 상태의 프로세스가 중기 스케줄러에 의해 디스크로 swap out
* 봉쇄 중지(suspended block) : 봉쇄 상태의 프로세스가 중기 스케줄러에 의해 디스크로 swap out

중지 봉쇄 상태인 프로세스가 봉쇄 되었던 조건을 만족하게 되면 이 프로세스의 상태는 중지 준비 상태로 바뀌게 된다.   
중지 상태에 있는 프로세스들은 중지 준비 상태이든 중지 봉쇄 상태이든 관계없이 메모리를 조금도 보유하지 않고 디스크에 통째로 스왑 아웃된 상태로 존재하게 된다.  

## 3. 단기 스케줄러

> 메모리 내의 준비 상태에 있는 작업 중 실행 할 프로세스를 선택하여 CPU를 할당

* CPU스케줄러라고도 하며 준비 상태의 프로세스 중에서 어던 프로세스를 다음 번에 실행 상태로 만들 것인지를 결정
* 시분할 시스템에서 타이머 인터럽트가 발생하면 단기 스케줄러가 호출
* 일반적으로 스케줄러라 함은 단기 스케줄러를 의미하며 단기 스케줄러는 미리 정한 스케줄링 알고리즘에 따라 cpu를 할당 할 프로세스를 선택
* 단기 스케줄러는 밀리 세컨트(ms) 이하의 시간 단위로 매우 빈번하게 호출되기 때문에 수행 속도가 충분히 빨라야 함
